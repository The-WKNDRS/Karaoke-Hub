<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Venue Profile</title>
    <link rel="icon" type="image/x-icon" href="/img/karaoke-icon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
    <link rel="stylesheet" th:href="@{/css/resets.css}">
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/venue-profile.css}">
    <link rel="stylesheet" th:href="@{/css/navbar.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">
</head>
<body>
<div class="page-wrapper">
    <div th:insert="fragments/navbar.html :: navbar"></div>
    <div class="row images appear">
        <div class="img-wrapper"></div>
        <div class="name-rating">
            <p th:text="${venue.name}" class="name"></p>
            <div class="rating"></div>
            <ul class="categories"></ul>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="column left">
                <h3 class="appear">Business hours</h3>
                <div class="business-hours row justify-center appear">
                    <div class="column shrink days">

                    </div>
                    <div class="column hours"></div>
                </div>
                <h3 class="appear">Karaoke event hours</h3>
                <div class="karaoke-hours appear">
                    <div class="karaoke">
                        <div class="karaoke-event" th:each="event : ${events}">
                            <p class="karaoke-time"><span th:text="${event.day_of_week}"></span><span th:text="${event.start_time}"></span> - <span th:text="${ event.end_time}"></span></p>
                            <img th:id="${event.id}" class="edit-icon hide" src="/img/edit1.png">
                        </div>
                    </div>
                </div>
                <hr class="appear">
                <h3 sec:authorize="isAuthenticated()" class="appear">Leave a comment</h3>
                <div class="leave-review appear" sec:authorize="isAuthenticated()">
                    <form th:action="@{/venue/comment}" th:method="post">
                        <div class="form-group">
                            <label for="body"></label>
                            <textarea cols="50" rows="3" name="body" id="body"></textarea>
                            <button class="review-btn">Post comment</button>
                            <input type="hidden" th:value="${venue.id}" name="venue_id">
                        </div>
                    </form>
                </div>
                <h3 class="appear">Comments</h3>
                <div class="reviews-wrapper appear">
                    <div th:if="${numComments} > 0" class="review" th:each="comment : ${comments}">
                        <div class="profile">
                            <h4>@<span th:text="${comment.user.getUsername()}"></span></h4>
                            <a class="helpful" th:href="@{|/venue/${venue.id}comment/upvote/${comment.id}|}"><img class="thumb" src="/img/thumb.png"></a>
                        </div>
                        <p th:text="${comment.body}"></p>
                        <br>
                        <div th:if="${comment.upVotes} == 1" class="helpful-display">
                            <h5><span th:text="${comment.upVotes}"></span> person found this comment helpful</h5>
                        </div>
                        <div th:if="${comment.upVotes} > 1" class="helpful-display">
                            <h5><span th:text="${comment.upVotes}"></span> people found this comment helpful</h5>
                        </div>
                        <hr>
                    </div>
                    <div th:if="${numComments} == 0" class="review" >
                        <h4 sec:authorize="isAuthenticated()">Be the first to comment!</h4>
                        <h4 sec:authorize="isAnonymous()">Login to comment</h4>
                    </div>
                </div>
                <div sec:authorize="isAuthenticated()" th:if="${numComments} > 4" class="see-all appear">
                    <img class="comment-arrow" src="/img/arrow.png" alt="arrow">
                </div>
            </div>
            <div class="column align-center">
                <div class="contact-info column shrink appear">
                    <div class="row justify-space-between align-center">
                        <p th:if="${venue.website.isEmpty()}">No website available</p>
                        <a th:unless="${venue.website == true}" th:href="${venue.website}" target="_blank"><p th:text="${venue.website}" class="website"></p></a>
                        <a th:href="${venue.website}" target="_blank"><img class="icon" src="/img/redirect.png"></a>
                    </div>
                    <hr />
                    <div class="row justify-space-between align-center">
                        <p class="phone"></p>
                        <img class="icon" src="/img/phone.png">
                    </div>
                    <hr />
                    <div class="row justify-space-between align-center">
                        <div class="column">
                            <p th:text="${venue.address}"></p>
                            <p><span th:text="${venue.city}"></span>, <span th:text="${venue.state}"></span> <span th:text="${venue.zip_code}"></span></p>
                        </div>
                        <img class="icon" src="/img/map.png">
                    </div>
                    <hr sec:authorize="isAuthenticated()"/>
                    <div sec:authorize="isAuthenticated()" class="edit">
                        <h3>Edit profile</h3>
                        <img class="edit-img" src="/img/edit1.png">
                    </div>
                </div>
                <div sec:authorize="isAuthenticated()" class="events">
                    <a class="create-event"><button>Create event</button></a>
                    <a><button class="edit-event">Edit events</button><img class="x hide" src="/img/x.png"></a>
                </div>
            </div>
        </div>
    </div>

    <div class="edit-modal">
        <div class="modal">
            <form class="edit-form" th:action="@{/create-venue}" th:object="${venue}" th:method="post">
                <input type="hidden" th:field="*{id}" />
                <div class="form-group">
                    <label for="name">Name</label>
                    <input id="name" name="name" th:field="*{name}">
                </div>
                <div class="form-group">
                    <label for="address">Address</label>
                    <input id="address" name="address" th:field="*{address}">
                </div>
                <div class="form-group">
                    <label for="city">City</label>
                    <input id="city" name="city" th:field="*{city}">
                </div>
                <div class="form-group">
                    <label for="state">State</label>
                    <input id="state" name="state" th:field="*{state}">
                </div>
                <div class="form-group">
                    <label for="zip_code">Zip Code</label>
                    <input id="zip_code" name="zip_code" th:field="*{zip_code}">
                </div>
                <div class="form-group">
                    <label for="website">Website</label>
                    <input id="website" name="website" th:field="*{website}">
                </div>
                <div class="form-group">
                    <label for="yelp_id">Yelp ID</label>
                    <input id="yelp_id" name="yelp_id" th:field="*{yelp_id}">
                </div>
                <input class="submit-edit" type="submit" value="Submit Edit">
            </form>
            <div class="delete">
                <a th:href="@{|/delete-venue/${venue.id}|}"><img class="delete-btn" src="/img/delete.png"></a>
            </div>
        </div>
    </div>
    <div class="create-event-modal">
        <div class="modal">
            <form class="edit-form" th:action="@{|/venue/${venue.id}/create_event|}" th:method="post">
                <div class="form-group">
                    <label class="day-select" for="day">Day</label>
                    <select id="day" name="day">
                        <option>Monday</option>
                        <option>Tuesday</option>
                        <option>Wednesday</option>
                        <option>Thursday</option>
                        <option>Friday</option>
                        <option>Saturday</option>
                        <option>Sunday</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="start">Start time</label>
                    <input id="start" name="start" type="time">
                </div>
                <div class="form-group">
                    <label for="end">End time</label>
                    <input id="end" name="end" type="time">
                </div>
                <div class="form-group">
                    <label for="dj">Dj name</label>
                    <input id="dj" name="dj" >
                </div>
                <input class="submit-edit" type="submit" value="Create Event">
            </form>
        </div>
    </div>
    <div class="edit-event-modal" th:each="event : ${events}" th:id="${event.id} + e">
        <div class="modal">
            <form class="edit-event-form" th:action="@{|/venue/${venue.id}/edit_event/${event.id}|}" th:method="post">
                <div class="form-group">
                    <label class="day-select" for="day">Day</label>
                    <select id="day-select" name="day">
                        <option></option>
                        <option>Monday</option>
                        <option>Tuesday</option>
                        <option>Wednesday</option>
                        <option>Thursday</option>
                        <option>Friday</option>
                        <option>Saturday</option>
                        <option>Sunday</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="start">Start time</label>
                    <input id="start-edit" name="start" type="time" th:value="*{event.start_time}">
                </div>
                <div class="form-group">
                    <label for="end">End time</label>
                    <input id="end-edit" name="end" type="time" th:value="${event.end_time}">
                </div>
                <div class="form-group">
                    <label for="dj">Dj name</label>
                    <input id="dj-edit" name="dj" th:value="${event.dj}">
                </div>
                <input class="submit-edit" type="submit" value="Edit Event">
            </form>
        </div>
    </div>
    <div th:insert="fragments/navbar.html :: footer"></div>
</div>
<input class="venueName" type="hidden" th:value="${venue.name}">
<input class="venueZip" type="hidden" th:value="${venue.zip_code}">
<script src="/js/venue-profile.js"></script>
</body>
</html>